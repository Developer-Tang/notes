## 数据不一致

缓存和数据库数据一致性问题：分布式环境下非常容易出现缓存和数据库间数据一致性问题

**解决思路**

1. 要求是强一致性的，那么就不要使用缓存
2. 通过合适的缓存更新策略，更新数据库后及时更新缓存、缓存失败时增加重试机制

## 缓存雪崩

缓存在同一时间大面积的失效，从而导致所有的请求都去查数据库，导致数据库CPU和内存负载过高甚至宕机

**解决思路**

1. 对服务访问进行限流
2. 设置缓存过期时间时加上随机值，尽可能的将失效时间分散

## 缓存击穿

针对某个热点数据，突然在缓存中失效，然后大量请求涌入到数据库

**解决思路**

1. 热点数据设置较长的过期时间或永久有效
2. 定时刷新热点数据过期时间

## 缓存穿透

查询一个不存在的数据。缓存无法命中，需要每次都从数据库中查询，查不到数据则不写入缓存，导致这个不存在的数据每次被请求时都需要去查询数据库，造成缓存穿透

**解决思路**

1. 过滤掉一些明显格式错误的key
2. 当缓存未命中且查询数据库也不存在数据时，在缓存中设置空对象并设置一个较短的过期时间，后续请求不在查询数据库，当有数据及时删除/更新旧的缓存

## 缓存预热

系统上线后，将相关的缓存数据直接加载到缓存系统，用户直接查询已缓存的数据，从而避免开放后大量用户请求造成数据压力大

**解决思路**

1. 提供一个缓存刷新接口，需要的时候手动调用或通过管理页面进行调用
2. 数据量较小时也可以在项目启动时直接加载到缓存中

## 缓存降级

缓存失效或者缓存服务挂掉的情况下，也不去访问数据库。直接访问内存部分数据缓存或者直接返回默认数据

**解决思路**

1. 提供一个缓存刷新接口，需要的时候手动调用或通过管理页面进行调用
2. 数据量较小时也可以在项目启动时直接加载到缓存中
